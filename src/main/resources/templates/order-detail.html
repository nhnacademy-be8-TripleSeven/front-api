<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="'상품 상세 - ' + ${book.title}">상품 상세</title>
  <link rel="stylesheet" th:href="@{/css/order-detail.css}">
  <link rel="stylesheet" th:href="@{/css/global.css}">
</head>
<body>
<div th:replace="header :: header"></div>
<main>
  <section class="product-info">
    <img th:src="@{/image/book2.png}" alt="도서 이미지">
    <div class="product-details">
      <h1 th:text="${book.title}">모두의 크리스마스</h1>
      <ul>
        <li th:text="'저자: ' + ${book.author}">저자: 김재니</li>
        <li th:text="'출판사: ' + ${book.publisher}">출판사: 웅진주니어</li>
        <li th:text="'발행일: ' + ${book.publishedDate}">발행일: 2024-11-19</li>
        <li>정가: <span class="original" th:text="${book.price} + '원'">18,000원</span></li>
        <li>판매가: <span class="discount" th:text="${book.discountedPrice} + '원'">16,200원</span> (10% 할인)</li>
        <li th:text="'배송비: ' + ${book.shippingCost}">배송비: 무료배송</li>
        <li th:text="'수령예상일: ' + ${book.deliveryType}">수령예상일: NHN배송</li>
      </ul>
      <div class="rating">
        <span th:text="'★★★★★'.substring(0, ${book.rating}) + '☆☆☆☆☆'.substring(0, 5 - ${book.rating})">★★★★★</span>
        <span th:text="${book.rating}">10.0</span>
        <span th:text="'(' + ${book.reviewCount} + '자평)'">(100자평)</span>
      </div>
      <div class="actions">
        <a th:href="@{/cart/add/{id}(id=${book.id})}"><button class="cart-btn">장바구니 담기</button></a>
        <a th:href="@{/purchase/{id}(id=${book.id})}"><button class="buy-btn">바로구매</button></a>
      </div>
    </div>
  </section>

  <section class="details">
    <h2>기본정보</h2>
    <ul>
      <li th:text="${book.details}">양장본 | 52쪽 | 170x235mm | 295g | ISBN: 9788901290157</li>
      <li th:text="${book.category}">주제 분류: 신간그림책</li>
      <li th:text="${book.subCategory}">국내도서 > 유아 > 그림책 > 나라별 그림책 > 한국 그림책</li>
    </ul>
  </section>


  <section class="book-intro">
    <h2>책 소개</h2>
    <p th:text="${book.description}">
      여기, 누구보다 크리스마스를 특별하게 보내는 한 아이가 있다...
    </p>
  </section>


  <section class="review-section">
    <div class="review-header">
      <h2>구매자 리뷰</h2>
      <p>배송 음이나 욕설 및 인신공격성 글은 상품 페이지에서 노출 제재처리됩니다.</p>
    </div>


    <div class="review-stats">
      <div class="purchase-distribution">
        <h3>구매자 분포</h3>
        <ul>
          <li th:each="group : ${reviewStatistics.ageGroups}">
            <span th:text="${group.label}">10대:</span> <span th:text="${group.percentage + '%'}">0.7%</span>
          </li>
        </ul>
      </div>
      <div class="rating-distribution">
        <h3>평점 분포</h3>
        <ul>
          <li th:each="rating : ${reviewStatistics.ratingDistribution}">
            <span th:text="'★'.repeat(${rating.stars}) + '☆'.repeat(5 - ${rating.stars})">★★★★★:</span>
            <span th:text="${rating.percentage + '%'}">100%</span>
          </li>
        </ul>
        <p class="overall-rating">평점: <strong th:text="${reviewStatistics.averageRating}">10.0</strong></p>
      </div>
    </div>

    <div class="review-list">
      <h3>구매자 리뷰</h3>
      <div class="review-item" th:each="review : ${reviews}">
        <p th:text="'★'.repeat(${review.rating}) + '☆'.repeat(5 - ${review.rating})">★★★★★</p>
        <p th:text="${review.content}">
          여기 조금 이상하고 특별한 '썸머'라는 아이가 있다...
        </p>
        <div class="review-meta">
          <span th:text="${review.user}">user22</span>
          <span th:text="${review.date}">2024-11-30</span>
          <span th:text="'도움됨 ' + ${review.helpfulCount}">도움됨 9</span>
        </div>
      </div>
    </div>


    <div class="review-form">
      <h3>리뷰 작성</h3>
      <form th:action="@{/review/add}" method="post">
        <label for="review-rating">평점:</label>
        <select id="review-rating" name="rating">
          <option value="5">★★★★★</option>
          <option value="4">★★★★☆</option>
          <option value="3">★★★☆☆</option>
          <option value="2">★★☆☆☆</option>
          <option value="1">★☆☆☆☆</option>
        </select>
        <textarea name="content" placeholder="리뷰를 작성하세요..."></textarea>
        <button type="submit">등록</button>
      </form>
    </div>
  </section>


  <section class="return-info">
    <h2>반품/교환 안내</h2>
    <table>
      <tr>
        <th>반품/교환 방법</th>
        <td>“내계좌>주문조회>반품/교환신청”</td>
      </tr>
      <tr>
        <th>반품/교환 가능기간</th>
        <td>상품 수령 후 20일 이내</td>
      </tr>
      <tr>
        <th>반품/교환 비용</th>
        <td>고객 부담</td>
      </tr>
    </table>
  </section>
</main>

<div th:replace="footer :: footer"></div>
</body>
</html>